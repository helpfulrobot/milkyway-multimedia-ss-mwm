var mwm=window.mwm||{};mwm.alerts=function(t,e,a){var i=t.alerts||{},o={alerts:{success:"alert-success",error:"alert-error",hide:"hide",hideForm:"hide",animation:"subtle-bounce",animated:"animated",invisible:"invisible",position:"center"},notify:{timeout:3,position:"top"},vex:{className:"vex-theme-default",focusFirstInput:!1},top:{prependTo:"body",bar:'<div id="FlashNotifications" class="notifications-flash"></div>',message:'<div class="notifications-flash--item notifications-flash--item_{{ level }}" data-content="{{ content }}" data-id="{{ id }}"><div class="notifications-flash--item-content">{{ content }}</div></div>',dismissable:'<span class="close notifications-flash--item-close" data-dismiss="notifications-flash--item" aria-label="Close"><span aria-hidden="true">&times;</span></span>',initCheck:function(){return i.top.$bar.length||e("#FlashNotifications").length},classes:{animated:"notifications-flash_in"}}},n=function(){return e&&"function"==typeof e().modal},s=function(t,e){"top"==e?t.css({top:0,bottom:"auto"}).addClass("notification-top"):"bottom"==e?t.css({top:"auto",bottom:0}).addClass("notification-bottom"):"left"==e?t.css({left:0,right:"auto"}).addClass("notification-left"):"right"==e?t.css({left:"auto",right:0}).addClass("notification-right"):t.removeClass("notification-top notification-bottom notification-left notification-right")},r=function(){o.top.initCheck()||(i.top.$bar=e(o.top.bar),e(o.top.prependTo).prepend(i.top.$bar))};return i.configure=function(t){o=e.extend(!0,{},o,t)},i.message=function(t,r){var l,m=t.Content?t.Content:t.message;if(t.redirect&&(e("body").addClass("loading-redirect"),window.location=t.redirect),m&&!t.hideMessage)if(t.$form&&t.$form.data("onMessageClass")&&t.$form.addClass(t.$form.data("onMessageClass")),n()&&!t.hideModal&&t.$modal&&!e(".modal-backdrop").length)t.Title&&t.$modal.find('[role="title"]').html(t.Title),m&&t.$modal.find('[role="content"]').html(m),t.$modal.modal(),t.$modal.off("hidden.bs.modal.forms.mwm").on("hidden.bs.modal.forms.mwm",function(){var e=t.$form?t.$form.find(".form-group.error"):t.$modal.parents("form").find(".form-group.error");e.length&&e.first().find(":input:not(:hidden)").first().focus(),r&&r(),t.$modal.trigger("mwm::alert",["modal",t]),t.$form&&t.$form.trigger("mwm::alert",[type,t])}),i.clear(t);else if(!t.hideAlert&&t.$alert&&t.$alert.length)t.hideForm&&(t.$form?t.$form.addClass(o.alerts.hideForm):t.$alert.parents("form:first").addClass(o.alerts.hideForm)),t.success&&t.success!==!1?t.$alert.removeClass(o.alerts.error).addClass(o.alerts.success).html(m):t.$alert.removeClass(o.alerts.success).addClass(o.alerts.error).html(m),l=t.$alert.data("animate"),l||(l=o.alerts.animation),t.$alert.hasClass(o.alerts.invisible)?t.$alert.removeClass(o.alerts.invisible+" "+o.alerts.hide).addClass(o.alerts.animated+" "+l):t.$alert.hasClass(o.alerts.animated)?(t.$alert.removeClass(o.alerts.animated+" "+l).addClass(o.alerts.invisible),setTimeout(function(){t.$alert.removeClass(o.alerts.invisible+" "+o.alerts.hide).addClass(o.alerts.animated+" "+l)},50)):t.$alert.removeClass(o.alerts.hide),t.$alert.trigger("mwm::alert",["html",t]),t.$form&&t.$form.trigger("mwm::alert",[type,t]);else if(a){type="vex";var d=t.positionAlert?t.positionAlert:o.alerts.position,f=a.dialog.alert(e.extend({},o.vex,{message:m})).bind("vexOpen.mwm",function(e,a){s(a.$vex,d),t.closeAfter||(r&&r(),t.$form&&t.$form.trigger("mwm::alert",[type,t]))});t.closeAfter&&setTimeout(function(){a.close(f.data().vex.id),r&&r(),t.$form&&t.$form.trigger("mwm::alert",[type,t])},1e3*t.closeAfter)}else alert(m),r&&r(),t.$form&&t.$form.trigger("mwm::alert",[type,t])},i.notify=function(t,i){var n=t.Content?t.Content:t.message;if(n&&!t.hideMessage){var r=t.Timeout?t.Timeout:o.notify.timeout;if(r*=1e3,a){var l=e.extend({},o.vex,{message:n}),m=t.position?t.position:o.notify.position,d=a.dialog.alert(l).bind("vexOpen.mwm",function(a,o){s(o.$vex,m),r&&(i&&i(),t.$form&&t.$form.trigger("mwm::notification",[t]),e.event.trigger("mwm::notification",[t]))});r&&setTimeout(function(){d.data()&&d.data().vex&&d.data().vex.id&&a.close(d.data().vex.id),i&&i(),t.$form&&t.$form.trigger("mwm::notification",[t]),e.event.trigger("mwm::notification",[t])},r)}}},i.button=function(i,n,s){var r=!0;if(i&&i.length&&(i.data("alertContent")||i.data("alertTarget"))){var l=i.data("alertTarget"),m=i.data("alertType")?i.data("alertType"):"alert",d=i.data("alertIf"),f=e({},o.vex,{message:i.data("alertContent"),buttons:i.data("alertButtons")?i.data("alertButtons"):{}}),c=function(i,o){if(i&&(f.message="string"==typeof i?i:e(i).text()),o&&(f.className=f.className?f.className+" "+o:o),buttons&&buttons.cancel&&(buttons.cancel.click=function(t){return t.data().vex.value=!1,a.close(t.data().vex.id)}),d&&!e(d).length)return r;if("alert"===m)a?a.dialog.alert(f):alert(f.message);else if("confirm"===m){t&&t.forms&&t.forms.submit&&(t.forms.submit.submitting=!0),r=!1;var l=!1;a?(f.callback=function(e){t&&t.forms&&t.forms.submit&&(t.forms.submit.submitting=!0),n&&e?n():s&&!e&&s()},a.dialog.confirm(f)):(l=confirm(f.message),n&&l?n():s&&!l&&s())}return null};if(l)if(0===l.indexOf("#")&&e(l).length){var u=e(l),p="";if(u.data("modal")){var g=u.find(".modal-content").find("[role=title]");g.length&&(p+=g[0].outerHTML),p+=u.find(".modal-content").find("[role=content]").html(),c(p,"button-alert-from-modal")}else p=u.html(),c(p,"button-alert-from-html")}else e.get(l,function(t){c(t,"button-alert-from-url")});else c(null,"button-alert-from-attribute")}return r},i.clear=function(t){t.$alert&&t.$alert.length&&t.$alert.addClass(o.alerts.hide)},i.top=i.top||{},i.top.$bar=i.top.$bar||[],i.top.message=function(t){r();var a=t.Content?t.Content:t.message?t.message:t.content,n=t.id?t.id:a;if(a&&!i.top.$bar.find('[data-id="'+n+'"]').length){var s=e(o.top.message.replace(new RegExp("{{ level }}","g"),t.level||"info").replace(new RegExp("{{ content }}","g"),a).replace(new RegExp("{{ id }}","g"),n));if(t.dismissable){var l=e(o.top.dismissable);s.prepend(l),l.one("click",function(){i.top.clear(s)})}i.top.$bar.append(s).addClass(o.top.classes.animated).parent().addClass(o.top.classes.animated),setTimeout(function(){s.addClass(o.top.classes.animated),t.timeout&&setTimeout(function(){s.removeClass(o.top.classes.animated)},1e3*t.timeout),i.top.$bar.trigger("mwm::top:alert",[s,t])},500)}},i.top.clear=function(t){r();var a=null;t?(a=t instanceof e?t:i.top.$bar.children().filter(function(){return e(this).data("id")==t}),a.removeClass(o.top.classes.animated),a.one("webkitTransitionEnd mozTransitionEnd MSTransitionEnd otransitionend transitionend",function(){e(this).remove()})):i.top.$bar.removeClass(o.top.classes.animated).text("").parent().removeClass(o.top.classes.animated),i.top.$bar.trigger("mwm::top:cleared",[a,t])},i}(window.mwm||{},window.jQuery||window.Zepto||window.Sprint,window.vex||null),window.flash_message=function(t,e){if(t.hasOwnProperty("alerts")){var a=window.flash_message||{};return a.ajax=function(i,o,n){e.isArray(o)||(o=o?o.split(","):[]);var s=[],r=function(){e.get(i).done(function(i){if(i!==!1){i&&e.isArray(i)&&(s=s.concat(i)),s=s.sort(function(t,e){return t.priority<e.priority?-1:t.priority>e.priority?1:0});for(var r=0;r<s.length;r++)t.alerts.top.message(s[r]);if(n){var l=n.hasOwnProperty("link")?n.link:n,m=n.hasOwnProperty("timeout")?n.timeout:5e3,d=n.hasOwnProperty("before")?n.before:o;setTimeout(function(){a.ajax(l,d,n)},m)}}})};if(o.length)for(var l=0,m=0;m<o.length;m++)e.get(o[m]).done(function(t){t&&e.isArray(t)&&(s=s.concat(t))}).always(function(){l++,l===o.length&&r()});else r()},a}}(window.mwm||{},window.jQuery||window.Zepto||window.Sprint||(window.mwm&&mwm.jquery?mwm.jquery:null));